name: Build
on:
  pull_request_target:
      types:
        - labeled
        - unlabeled
        - synchronize
        - opened
        - edited
        - ready_for_review
        - reopened
        - unlocked
  pull_request_review:
      types:
        - submitted

jobs:
  build:
    runs-on: ${{matrix.os}}
 
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macOS-latest]
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Get PR Number
        id: pr_number
        run: |
          # Extract the PR number from the GitHub reference (GITHUB_REF)
          PR_NUMBER=$(echo ${GITHUB_REF} | sed 's/refs\/pull\/\([0-9]*\)\/merge/\1/')
          echo "::set-output name=pr_number::$PR_NUMBER"

      - name: SetUp Python
        uses: actions/setup-python@v3
        with:
          python-version: '3.8'
 
      - name: Install dependencies
        run: |
            python -m pip install --upgrade pip
            pip install -r requirements.txt
 
      - name: Run tests
        run: pytest
